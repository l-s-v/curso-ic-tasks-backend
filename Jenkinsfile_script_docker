node {

    try {
	    stage('Checkout') {
			checkout scm
	    }

        docker.image('maven:3-alpine').inside('-v ~/.m2:/root/.m2') {
            stage ('Build Backend') {
                sh 'mvn -DskipTests=true clean package'
            }

            stage ('Unit Tests') {
                sh 'mvn test'
            } 
        }
    }
    finally {
        junit allowEmptyResults: true, testResults: 'target/surefire-reports/*.xml'
        // archiveArtifacts artifacts: 'target/tasks-backend.war, frontend/target/tasks.war', onlyIfSuccessful: true
    }    
}